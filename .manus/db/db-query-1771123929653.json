{
  "query": "CREATE TABLE `communities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`communityId` int NOT NULL,\n\t`level` int NOT NULL DEFAULT 0,\n\t`parentCommunityId` int,\n\t`title` varchar(500),\n\t`summary` text,\n\t`fullReport` text,\n\t`keyEntities` json,\n\t`entityCount` int DEFAULT 0,\n\t`edgeCount` int DEFAULT 0,\n\t`rank` float,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `communities_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `graphEdges` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`sourceEntityId` varchar(500) NOT NULL,\n\t`targetEntityId` varchar(500) NOT NULL,\n\t`relationshipType` varchar(100) NOT NULL,\n\t`description` text,\n\t`weight` float DEFAULT 1,\n\t`sourceRef` varchar(255),\n\t`mentionCount` int DEFAULT 1,\n\t`metadata` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graphEdges_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `graphNodes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`entityId` varchar(500) NOT NULL,\n\t`name` varchar(500) NOT NULL,\n\t`entityType` varchar(100) NOT NULL,\n\t`description` text,\n\t`source` varchar(50) DEFAULT 'stj',\n\t`sourceRef` varchar(255),\n\t`mentionCount` int DEFAULT 1,\n\t`communityId` int,\n\t`communityLevel` int,\n\t`metadata` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `graphNodes_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graphNodes_entityId_unique` UNIQUE(`entityId`)\n);\n\nALTER TABLE `documents` MODIFY COLUMN `status` enum('uploaded','extracting','extracted','chunking','chunked','extracting_entities','entities_extracted','embedding','embedded','error') NOT NULL DEFAULT 'uploaded';\nALTER TABLE `extractionLogs` MODIFY COLUMN `action` enum('sync_datasets','download_resource','process_json','extract_entities','build_communities','generate_embeddings','upload_document','process_document','rag_query') NOT NULL;\nALTER TABLE `resources` MODIFY COLUMN `status` enum('pending','downloading','downloaded','processing','processed','extracting_entities','entities_extracted','embedding','embedded','error') NOT NULL DEFAULT 'pending';\nALTER TABLE `documents` ADD `entityCount` int;\nALTER TABLE `extractionLogs` ADD `entitiesExtracted` int;\nALTER TABLE `extractionLogs` ADD `relationshipsExtracted` int;\nALTER TABLE `ragQueries` ADD `queryType` varchar(20) DEFAULT 'local';\nALTER TABLE `ragQueries` ADD `queryEntities` json;\nALTER TABLE `ragQueries` ADD `communitiesUsed` json;\nALTER TABLE `ragQueries` ADD `totalEntitiesRetrieved` int;\nALTER TABLE `ragQueries` ADD `reasoningChain` text;\nALTER TABLE `resources` ADD `entityCount` int;\nALTER TABLE `resources` ADD `relationshipCount` int;\nALTER TABLE `ragQueries` DROP COLUMN `collectionsSearched`;",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user WEqh79NFUWk2xxo.4729eca11dd4 --database mp44u2dfgM2YiYy9gC8tzc --execute CREATE TABLE `communities` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`communityId` int NOT NULL,\n\t`level` int NOT NULL DEFAULT 0,\n\t`parentCommunityId` int,\n\t`title` varchar(500),\n\t`summary` text,\n\t`fullReport` text,\n\t`keyEntities` json,\n\t`entityCount` int DEFAULT 0,\n\t`edgeCount` int DEFAULT 0,\n\t`rank` float,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `communities_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `graphEdges` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`sourceEntityId` varchar(500) NOT NULL,\n\t`targetEntityId` varchar(500) NOT NULL,\n\t`relationshipType` varchar(100) NOT NULL,\n\t`description` text,\n\t`weight` float DEFAULT 1,\n\t`sourceRef` varchar(255),\n\t`mentionCount` int DEFAULT 1,\n\t`metadata` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\tCONSTRAINT `graphEdges_id` PRIMARY KEY(`id`)\n);\n\nCREATE TABLE `graphNodes` (\n\t`id` int AUTO_INCREMENT NOT NULL,\n\t`entityId` varchar(500) NOT NULL,\n\t`name` varchar(500) NOT NULL,\n\t`entityType` varchar(100) NOT NULL,\n\t`description` text,\n\t`source` varchar(50) DEFAULT 'stj',\n\t`sourceRef` varchar(255),\n\t`mentionCount` int DEFAULT 1,\n\t`communityId` int,\n\t`communityLevel` int,\n\t`metadata` json,\n\t`createdAt` timestamp NOT NULL DEFAULT (now()),\n\t`updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n\tCONSTRAINT `graphNodes_id` PRIMARY KEY(`id`),\n\tCONSTRAINT `graphNodes_entityId_unique` UNIQUE(`entityId`)\n);\n\nALTER TABLE `documents` MODIFY COLUMN `status` enum('uploaded','extracting','extracted','chunking','chunked','extracting_entities','entities_extracted','embedding','embedded','error') NOT NULL DEFAULT 'uploaded';\nALTER TABLE `extractionLogs` MODIFY COLUMN `action` enum('sync_datasets','download_resource','process_json','extract_entities','build_communities','generate_embeddings','upload_document','process_document','rag_query') NOT NULL;\nALTER TABLE `resources` MODIFY COLUMN `status` enum('pending','downloading','downloaded','processing','processed','extracting_entities','entities_extracted','embedding','embedded','error') NOT NULL DEFAULT 'pending';\nALTER TABLE `documents` ADD `entityCount` int;\nALTER TABLE `extractionLogs` ADD `entitiesExtracted` int;\nALTER TABLE `extractionLogs` ADD `relationshipsExtracted` int;\nALTER TABLE `ragQueries` ADD `queryType` varchar(20) DEFAULT 'local';\nALTER TABLE `ragQueries` ADD `queryEntities` json;\nALTER TABLE `ragQueries` ADD `communitiesUsed` json;\nALTER TABLE `ragQueries` ADD `totalEntitiesRetrieved` int;\nALTER TABLE `ragQueries` ADD `reasoningChain` text;\nALTER TABLE `resources` ADD `entityCount` int;\nALTER TABLE `resources` ADD `relationshipCount` int;\nALTER TABLE `ragQueries` DROP COLUMN `collectionsSearched`;",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 6952
}